<!DOCTYPE html>
<html>
<head>
    <title>Uganda Malaria Cases Map</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        #map {
            width: 100%;
            height: 100vh;
        }
        .info {
            padding: 6px 8px;
            font: 14px/16px Arial, sans-serif;
            background: white;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
        }
        .info h4 {
            margin: 0 0 5px;
            color: #777;
        }
        .legend {
            line-height: 18px;
            color: #555;
        }
        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
        /* Glow effect for all markers */
        .district-marker {
            animation: glow 2s infinite alternate;
        }
        /* Different glow colors based on status */
        .high-glow {
            animation-name: high-glow;
        }
        .medium-glow {
            animation-name: medium-glow;
        }
        .low-glow {
            animation-name: low-glow;
        }
        @keyframes high-glow {
            from {
                box-shadow: 0 0 5px #fff, 0 0 10px rgba(255, 0, 0, 0.7), 0 0 15px rgba(255, 0, 0, 0.7);
            }
            to {
                box-shadow: 0 0 10px #fff, 0 0 20px rgba(255, 0, 0, 0.9), 0 0 30px rgba(255, 0, 0, 0.9);
            }
        }
        @keyframes medium-glow {
            from {
                box-shadow: 0 0 5px #fff, 0 0 10px rgba(255, 165, 0, 0.7), 0 0 15px rgba(255, 165, 0, 0.7);
            }
            to {
                box-shadow: 0 0 10px #fff, 0 0 20px rgba(255, 165, 0, 0.9), 0 0 30px rgba(255, 165, 0, 0.9);
            }
        }
        @keyframes low-glow {
            from {
                box-shadow: 0 0 5px #fff, 0 0 10px rgba(0, 255, 0, 0.7), 0 0 15px rgba(0, 255, 0, 0.7);
            }
            to {
                box-shadow: 0 0 10px #fff, 0 0 20px rgba(0, 255, 0, 0.9), 0 0 30px rgba(0, 255, 0, 0.9);
            }
        }
        /* Base marker style */
        .marker-circle {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            position: relative;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // District data with coordinates
            const districts = [
                {"district": "Abim", "latitude": 2.7032, "longitude": 33.6732},
                {"district": "Adjumani", "latitude": 3.3869, "longitude": 31.7909},
                {"district": "Agago", "latitude": 2.8394, "longitude": 33.3486},
                {"district": "Alebtong", "latitude": 2.2540, "longitude": 33.3486},
                {"district": "Amolatar", "latitude": 1.6346, "longitude": 32.8286},
                {"district": "Amudat", "latitude": 1.9500, "longitude": 34.9500},
                {"district": "Amuria", "latitude": 2.0150, "longitude": 33.6422},
                {"district": "Amuru", "latitude": 2.9500, "longitude": 32.0500},
                {"district": "Apac", "latitude": 1.9847, "longitude": 32.5385},
                {"district": "Arua", "latitude": 3.0191, "longitude": 30.9110},
                {"district": "Budaka", "latitude": 1.0833, "longitude": 33.9333},
                {"district": "Bududa", "latitude": 1.0000, "longitude": 34.3333},
                {"district": "Bugiri", "latitude": 0.5714, "longitude": 33.7412},
                {"district": "Bugweri", "latitude": 0.5785, "longitude": 33.5378},
                {"district": "Buhweju", "latitude": -0.3142, "longitude": 30.3717},
                {"district": "Buikwe", "latitude": 0.3292, "longitude": 33.0806},
                {"district": "Bukedea", "latitude": 1.3500, "longitude": 34.0500},
                {"district": "Bukomansimbi", "latitude": -0.1500, "longitude": 31.6500},
                {"district": "Bukwo", "latitude": 1.2925, "longitude": 34.7425},
                {"district": "Bulambuli", "latitude": 1.3750, "longitude": 34.1667},
                {"district": "Buliisa", "latitude": 2.0833, "longitude": 31.4167},
                {"district": "Bundibugyo", "latitude": 0.7306, "longitude": 30.0419},
                {"district": "Bunyangabu", "latitude": 0.5000, "longitude": 30.1667},
                {"district": "Busia", "latitude": 0.4600, "longitude": 34.1000},
                {"district": "Butaleja", "latitude": 0.9419, "longitude": 33.9556},
                {"district": "Butambala", "latitude": 0.1711, "longitude": 32.1044},
                {"district": "Butebo", "latitude": 1.2346, "longitude": 33.9087},
                {"district": "Buvuma", "latitude": 0.2440, "longitude": 33.2364},
                {"district": "Buyende", "latitude": 1.2739, "longitude": 33.5158},
                {"district": "Dokolo", "latitude": 1.9167, "longitude": 33.1667},
                {"district": "Gulu", "latitude": 2.7746, "longitude": 32.2980},
                {"district": "Hoima", "latitude": 1.4356, "longitude": 31.3520},
                {"district": "Ibanda", "latitude": -0.1191, "longitude": 30.4994},
                {"district": "Iganga", "latitude": 0.6092, "longitude": 33.4686},
                {"district": "Isingiro", "latitude": -0.8194, "longitude": 30.8039},
                {"district": "Jinja", "latitude": 0.4242, "longitude": 33.2047},
                {"district": "Kabale", "latitude": -1.2486, "longitude": 29.9920},
                {"district": "Kabarole", "latitude": 0.6667, "longitude": 30.2750},
                {"district": "Kaberamaido", "latitude": 1.7667, "longitude": 33.1500},
                {"district": "Kagadi", "latitude": 0.9397, "longitude": 30.7987},
                {"district": "Kakumiro", "latitude": 0.7803, "longitude": 31.3244},
                {"district": "Kalangala", "latitude": -0.3073, "longitude": 32.2250},
                {"district": "Kaliro", "latitude": 0.8945, "longitude": 33.4789},
                {"district": "Kalungu", "latitude": -0.2100, "longitude": 31.7650},
                {"district": "Kampala", "latitude": 0.3136, "longitude": 32.5811},
                {"district": "Kamuli", "latitude": 0.9472, "longitude": 33.1197},
                {"district": "Kamwenge", "latitude": 0.1900, "longitude": 30.4533},
                {"district": "Kanungu", "latitude": -0.9500, "longitude": 29.7500},
                {"district": "Kapchorwa", "latitude": 1.4000, "longitude": 34.4500},
                {"district": "Kasese", "latitude": 0.1833, "longitude": 30.0833},
                {"district": "Katakwi", "latitude": 1.9167, "longitude": 34.0000},
                {"district": "Kayunga", "latitude": 0.7025, "longitude": 32.8886},
                {"district": "Kibaale", "latitude": 0.8000, "longitude": 31.0833},
                {"district": "Kiboga", "latitude": 0.9167, "longitude": 31.7667},
                {"district": "Kibuku", "latitude": 1.0623, "longitude": 33.8500},
                {"district": "Kiruhura", "latitude": -0.2000, "longitude": 30.8000},
                {"district": "Kiryandongo", "latitude": 1.9167, "longitude": 32.0833},
                {"district": "Kisoro", "latitude": -1.2833, "longitude": 29.6833},
                {"district": "Kitgum", "latitude": 3.2783, "longitude": 32.8867},
                {"district": "Koboko", "latitude": 3.4106, "longitude": 30.9600},
                {"district": "Kole", "latitude": 2.4333, "longitude": 32.8000},
                {"district": "Kotido", "latitude": 3.0333, "longitude": 34.1167},
                {"district": "Kumi", "latitude": 1.4856, "longitude": 33.9361},
                {"district": "Kwania", "latitude": 2.1492, "longitude": 32.7092},
                {"district": "Kween", "latitude": 1.4286, "longitude": 34.5439},
                {"district": "Kyankwanzi", "latitude": 1.2000, "longitude": 31.8000},
                {"district": "Kyegegwa", "latitude": 0.5000, "longitude": 31.0417},
                {"district": "Kyenjojo", "latitude": 0.6111, "longitude": 30.6350},
                {"district": "Lamwo", "latitude": 3.5317, "longitude": 32.8039},
                {"district": "Lira", "latitude": 2.2481, "longitude": 32.8998},
                {"district": "Luuka", "latitude": 0.7652, "longitude": 33.3024},
                {"district": "Luwero", "latitude": 0.8333, "longitude": 32.5000},
                {"district": "Lwengo", "latitude": -0.4167, "longitude": 31.4167},
                {"district": "Lyantonde", "latitude": -0.4033, "longitude": 31.1575},
                {"district": "Manafwa", "latitude": 0.9333, "longitude": 34.2833},
                {"district": "Maracha", "latitude": 3.2878, "longitude": 30.9403},
                {"district": "Masaka", "latitude": -0.3333, "longitude": 31.7167},
                {"district": "Masindi", "latitude": 1.6833, "longitude": 31.7167},
                {"district": "Mayuge", "latitude": 0.4500, "longitude": 33.4833},
                {"district": "Mbale", "latitude": 1.0806, "longitude": 34.1750},
                {"district": "Mbarara", "latitude": -0.6057, "longitude": 30.6485},
                {"district": "Mitooma", "latitude": -0.6094, "longitude": 30.0036},
                {"district": "Mityana", "latitude": 0.4170, "longitude": 32.0423},
                {"district": "Moroto", "latitude": 2.5387, "longitude": 34.6666},
                {"district": "Moyo", "latitude": 3.6600, "longitude": 31.7300},
                {"district": "Mpigi", "latitude": 0.2250, "longitude": 32.3136},
                {"district": "Mubende", "latitude": 0.5578, "longitude": 31.3956},
                {"district": "Mukono", "latitude": 0.3533, "longitude": 32.7553},
                {"district": "Nakapiripirit", "latitude": 1.8500, "longitude": 34.7167},
                {"district": "Nakaseke", "latitude": 0.9531, "longitude": 32.0833},
                {"district": "Nakasongola", "latitude": 1.3167, "longitude": 32.4500},
                {"district": "Namayingo", "latitude": 0.2353, "longitude": 33.8667},
                {"district": "Namisindwa", "latitude": 0.9124, "longitude": 34.3904},
                {"district": "Namutumba", "latitude": 0.8500, "longitude": 33.6833},
                {"district": "Napak", "latitude": 2.5233, "longitude": 34.2442},
                {"district": "Nebbi", "latitude": 2.4650, "longitude": 31.0886},
                {"district": "Ngora", "latitude": 1.4600, "longitude": 33.7772},
                {"district": "Ntoroko", "latitude": 1.0364, "longitude": 30.5316},
                {"district": "Ntungamo", "latitude": -0.8833, "longitude": 30.2667},
                {"district": "Nwoya", "latitude": 2.6300, "longitude": 32.0000},
                {"district": "Omoro", "latitude": 2.7100, "longitude": 32.6000},
                {"district": "Otuke", "latitude": 2.5167, "longitude": 33.5000},
                {"district": "Oyam", "latitude": 2.2781, "longitude": 32.4461},
                {"district": "Pader", "latitude": 2.8667, "longitude": 33.1667},
                {"district": "Pakwach", "latitude": 2.4722, "longitude": 31.4944},
                {"district": "Pallisa", "latitude": 1.1667, "longitude": 33.7167},
                {"district": "Rubanda", "latitude": -1.1833, "longitude": 29.8000},
                {"district": "Rubirizi", "latitude": -0.2667, "longitude": 30.1000},
                {"district": "Rukiga", "latitude": -1.1528, "longitude": 30.0067},
                {"district": "Rukungiri", "latitude": -0.8411, "longitude": 29.9278},
                {"district": "Sembabule", "latitude": -0.0775, "longitude": 31.4592},
                {"district": "Serere", "latitude": 1.5000, "longitude": 33.5667},
                {"district": "Sheema", "latitude": -0.5727, "longitude": 30.3786},
                {"district": "Sironko", "latitude": 1.2300, "longitude": 34.2500},
                {"district": "Soroti", "latitude": 1.7167, "longitude": 33.6167},
                {"district": "Tororo", "latitude": 0.6922, "longitude": 34.1800},
                {"district": "Wakiso", "latitude": 0.4057, "longitude": 32.4780},
                {"district": "Yumbe", "latitude": 3.4650, "longitude": 31.2481},
                {"district": "Zombo", "latitude": 2.5333, "longitude": 30.9167}
            ];

            // Generate synthetic malaria cases data
            function generateMalariaData() {
                const threshold = 500; // Set the threshold for high cases
                return districts.map(district => {
                    // Generate random cases between 100 and 1000
                    const cases = Math.floor(Math.random() * 900) + 100;
                    
                    // Determine status based on threshold
                    let status;
                    if (cases > threshold) {
                        status = 'high';
                    } else if (cases > threshold * 0.95) { // Within 5% of threshold
                        status = 'medium';
                    } else {
                        status = 'low';
                    }
                    
                    return {
                        ...district,
                        cases: cases,
                        status: status
                    };
                });
            }

            // Create the map centered on Uganda
            const map = L.map('map').setView([1.3733, 32.2903], 7);

            // Add OpenStreetMap base layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Generate malaria data
            const malariaData = generateMalariaData();

            // Function to get color based on status
            function getColor(status) {
                return status === 'high' ? 'red' :
                       status === 'medium' ? 'orange' : 'green';
            }

            // Function to get animation class based on status
            function getGlowClass(status) {
                return status === 'high' ? 'high-glow' :
                       status === 'medium' ? 'medium-glow' : 'low-glow';
            }

            // Create a feature group to hold our district markers
            const districtsLayer = L.layerGroup().addTo(map);

            // Add district markers with malaria data
            malariaData.forEach(data => {
                // Create a custom icon with glow effect
                const icon = L.divIcon({
                    className: `district-marker ${getGlowClass(data.status)}`,
                    html: `<div class="marker-circle" style="background-color: ${getColor(data.status)}"></div>`,
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                });

                const marker = L.marker([data.latitude, data.longitude], {
                    icon: icon,
                    riseOnHover: true
                });

                marker.bindPopup(`
                    <div style="min-width: 200px;">
                        <b>${data.district}</b><br>
                        Malaria Cases: <strong>${data.cases}</strong><br>
                        Status: <span style="color: ${getColor(data.status)}">${data.status}</span>
                        <div style="margin-top: 5px; height: 5px; width: 100%; 
                             background: linear-gradient(to right, #4CAF50 0%, #FFC107 50%, #F44336 100%); 
                             background-position: ${100 - (data.cases / 10)}% 0;
                             border-radius: 3px;"></div>
                    </div>
                `);

                marker.addTo(districtsLayer);
            });

            // Add legend
            const legend = L.control({position: 'bottomright'});
            legend.onAdd = function(map) {
                const div = L.DomUtil.create('div', 'info legend');
                const statuses = ['high', 'medium', 'low'];
                const colors = ['red', 'orange', 'green'];
                const labels = ['Above threshold', 'Within 5% of threshold', 'Below threshold'];

                div.innerHTML = '<h4>Malaria Cases Status</h4>';
                
                for (let i = 0; i < statuses.length; i++) {
                    div.innerHTML += 
                        '<i style="background:' + colors[i] + '"></i> ' + 
                        labels[i] + '<br>';
                }

                return div;
            };
            legend.addTo(map);

            // Add info control
            const info = L.control({position: 'topright'});
            info.onAdd = function(map) {
                this._div = L.DomUtil.create('div', 'info');
                this.update();
                return this._div;
            };
            info.update = function(props) {
                this._div.innerHTML = '<h4>Uganda Malaria Cases</h4>' + 
                    (props ? 
                        `<b>${props.district}</b><br>Cases: ${props.cases}` : 
                        'Click on a district for details');
            };
            info.addTo(map);
        });
    </script>
</body>
</html>